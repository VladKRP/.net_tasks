<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>На пути к правильным SQL транзакциям (Часть 1) / Хабр</title>
    <meta content='Dynamic' name='document-state'>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
    <link href="D:\CDP\.net_tasks\Week_10\Downloads\" rel="canonical">
      <meta property="fb:app_id" content="444736788986613">
<meta property="og:locale" content="ru_RU">
<meta property="og:type" content="article">
<meta property="fb:pages" content="472597926099084">
<meta property="og:url" content="https://habr.com/company/infopulse/blog/261097/">
<meta property="og:title" content="На пути к правильным SQL транзакциям (Часть 1)">

    <meta property="og:image" content="https://habrastorage.org/files/450/904/b8f/450904b8f477464c8afe5e3e9e72e9f6">
    <link rel="image_src" href="D:\CDP\.net_tasks\Week_10\Downloads\450904b8f477464c8afe5e3e9e72e9f6">
    <meta name="twitter:image" content="https://habrastorage.org/files/450/904/b8f/450904b8f477464c8afe5e3e9e72e9f6">
    <meta property="og:image" content="https://habrastorage.org/files/9cd/4b5/c33/9cd4b5c33b68472fa418af093cb58e7a">
    <link rel="image_src" href="D:\CDP\.net_tasks\Week_10\Downloads\9cd4b5c33b68472fa418af093cb58e7a">

<meta property="og:description" content="Мне часто приходилось сталкиваться с тем, что люди прекрасно понимают, что такое транзакции в базе данных и для чего они нужны, но при этом не всегда умеют...">
<meta name="twitter:description" content="Мне часто приходилось сталкиваться с тем, что люди прекрасно понимают, что такое транзакции в базе данных и для чего они нужны, но при этом не всегда умеют...">
<meta name="twitter:title" content="На пути к правильным SQL транзакциям (Часть 1)">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@habrahabr">
  <meta property="al:android:url" content="habrahabr://post/261097">
<meta property="al:android:app_name" content="Habrahabr">
<meta property="al:android:package" content="ru.habrahabr">
<meta property="al:windows_phone:url" content="habrahabr://post/261097">
<meta property="al:windows_phone:app_name" content="Habrahabr">
<meta property="al:windows_phone:app_id" content="460a6bd6-8955-470f-935e-9ea1726a6060">

    <meta name="google-play-app" content="app-id=ru.habrahabr">
    <link rel="apple-touch-icon" sizes="180x180" href="D:\CDP\.net_tasks\Week_10\Downloads\apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="D:\CDP\.net_tasks\Week_10\Downloads\favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="D:\CDP\.net_tasks\Week_10\Downloads\favicon-16x16.png">
<link rel="manifest" href="D:\CDP\.net_tasks\Week_10\Downloads\site.webmanifest">
<link rel="mask-icon" href="D:\CDP\.net_tasks\Week_10\Downloads\safari-pinned-tab.svg" color="#77a2b6">
<meta name="application-name" content="Хабр">
<meta name="msapplication-TileColor" content="#77a2b6">
<meta name="theme-color" content="#77a2b6">

    <link href="D:\CDP\.net_tasks\Week_10\Downloads\stylesheets.mobile.css" rel="stylesheet" media="all">
    <script>
  var adcm_config ={
    id:1034,
    platformId: 34,
    
    tags: ['hub_complete_code', 'hub_sql', 'hub_mssql', 'g_programming', 'g_data_management'],
    init: function () {
      window.adcm.call();
    }
  };
</script>
<script src="D:\CDP\.net_tasks\Week_10\Downloads\adcm.js" async=""></script>
    <script src="D:\CDP\.net_tasks\Week_10\Downloads\advertise.js"></script>
    <script src="D:\CDP\.net_tasks\Week_10\Downloads\adriver.js"></script>
    <script>
  window.create_callback_for_blocked = function(key) {
    return function() {
      googletag.cmd.push(function () {
        googletag.display(key);
      });
    }
  }

  window.habr_blockers_checker = new function() {
    var result;
    var callbacksQueue = [];
    var calledOnce = false;

    function fireCallbacks() {
      callbacksQueue.forEach(function(callback) {
        callback(result);
      });
      callbacksQueue = [];
    }

    this.detect = function(imgUrl, callback) {
      var checksRemain = 2;
      var detected = false;
      var error1 = false;
      var error2 = false;

      if (typeof callback !== 'function') {
        return;
      };

      callbacksQueue.push(callback);

      if (typeof result !== 'undefined') {
        fireCallbacks();
      };

      if (calledOnce) {
        return;
      }
      calledOnce = true;

      imgUrl += '?ch=*&rn=*';

      function beforeCheck(timeout) {
        if (checksRemain === 0 || timeout > 1E3) {
          result = checksRemain === 0 && detected;
          fireCallbacks();
        } else {
          setTimeout(function() {
            beforeCheck(timeout * 2)
          }, timeout * 2);
        }
      }

      function checkImages() {
        if (--checksRemain) {
          return;
        };
        detected = !error1 && error2;
      }

      var random = Math.random() * 11;

      var img1 = new Image;
      img1.onload = checkImages;
      img1.onerror = function() {
        error1 = true;
        checkImages()
      };
      img1.src = imgUrl.replace(/\*/, 1).replace(/\*/, random);

      var img2 = new Image;
      img2.onload = checkImages;
      img2.onerror = function() {
        error2 = true;
        checkImages()
      };
      img2.src = imgUrl.replace(/\*/, 2).replace(/\*/, random);

      beforeCheck(250, callback)
    };

    this.detectWrapper = function(callback) {
      return this.detect('/images/px.gif', callback);
    };
  };

  window.display_dfp_slot = function(key) {
    if (window.habr_blockers_checker) {
      window.habr_blockers_checker.detectWrapper(window.create_callback_for_blocked(key));
    } else {
      window.create_callback_for_blocked(key)();
    }
  };
</script>

    
  </head>

  <body>
    <div id="layout">
      <div id="header">
  <a href="D:\CDP\.net_tasks\Week_10\Downloads\" class="logo"></a>
    <div class="title">На пути к правильным SQL транзакциям (Часть 1) / Хабр</div>
  <div class="toggle_sidebar"></div>
</div>
      <div id="content">
          
  <div class="post_show">
      <div class="hubs">
        <a href="D:\CDP\.net_tasks\Week_10\Downloads\" class="hub">Совершенный код</a><span class="profiled_hub" title="Профильный хаб">*</span>, 
        <a href="D:\CDP\.net_tasks\Week_10\Downloads\" class="hub">SQL</a><span class="profiled_hub" title="Профильный хаб">*</span>, 
        <a href="D:\CDP\.net_tasks\Week_10\Downloads\" class="hub">Microsoft SQL Server</a><span class="profiled_hub" title="Профильный хаб">*</span>, 
        <a href="D:\CDP\.net_tasks\Week_10\Downloads\" class="hub">Блог компании Инфопульс Украина</a>
      </div>

    <h3 class="title">
      На пути к правильным SQL транзакциям (Часть 1)
    </h3>

    
    
    
    

    <div class="meta">
      <a href="D:\CDP\.net_tasks\Week_10\Downloads\" class="author">david_off</a>
      <span class="time">25 июня 2015 в 13:40</span>
      <span class="viewed icon_view" title="Количество просмотров">68,2k</span>
    </div>

    <div data-io-article-url="https://m.habr.com/company/infopulse/blog/261097/" class="text text_html js-mediator-article" id="post_text"><img src="D:\CDP\.net_tasks\Week_10\Downloads\450904b8f477464c8afe5e3e9e72e9f6" align="left"><br>
<br>
Мне часто приходилось сталкиваться с тем, что люди прекрасно понимают, что такое транзакции в базе данных и для чего они нужны, но при этом не всегда умеют ими правильно пользоваться. Безусловно, для достижения 80-го уровня сакрального знания нужно иметь не один год опыта и прочесть множество толстенных книг по SQL. Поэтому в этой статье я даже не буду пытаться описать всё, что может быть связано с транзакциями в MS SQL. Я хочу затронуть один простой, но очень важный вопрос, который разработчики часто упускают из вида – уровни изоляции транзакций.<br>
Несмотря на то, что тема очень проста, во многих источниках она освящается плохо – информации либо очень мало, либо очень много. Т.е. прочитав 5-6 кратких теоретических определений невозможно их применить на практике. Для уверенного понимания предмета статьи нужно обращаться к специализированной литературе, но там информации на столько много, что далеко не каждый может уделить необходимое время для её усваивания.<br>
Сегодня я хочу поделиться своим простым рецептом, который помог мне раз и на всегда запомнить особенности уровней изоляции транзакций и по сей день помогает без проблем принимать взвешенные решения о выборе необходимого уровня.<br>
<a name="habracut"></a><br>
Секрет предлагаемого способа запоминания в том, что краткая теория будет сопровождаться простыми практическими примерами, которые мне были бы на много понятней, чем подробное описание.<br>
И так, для понимания различий в уровнях изоляции необходимо разобраться с нежелательными побочными эффектами, которые могут возникать, если транзакции будут не изолированы друг от друга. Поняв специфику этих эффектов, нам останется только посмотреть, от каких эффектов защищает каждый отдельно взятый уровень. После этого, я уверен, что тема изоляции транзакций вам навсегда перестанет казаться чем-то заоблачно сложным.<br>
<br>
<h4>Побочные эффекты параллелизма</h4><br>
Все операции в базе происходят не мгновенно и при одновременном изменении данных различными пользователями возможны следующие побочные эффекты:<br>
<ul>
<li>Потерянное обновление (lost update)</li>
<li>«Грязное» чтение (dirty read)</li>
<li>Неповторяющееся чтение (non-repeatable read)</li>
<li>Фантомное чтение (phantom reads)</li>
</ul><br>
Далее, эти эффекты рассматриваются подробно и приводятся SQL скрипты, показывающие проблему на практике. Я настоятельно рекомендую попробовать выполнить их и увидеть проблему «в живую», но для этого нужно сначала подготовить ваш сервер. Шаги по подготовки и особенности запуска скриптов описаны ниже.<br>
<div class="spoiler"><b class="spoiler_title">Требования для запуска скриптов</b><div class="spoiler_text"><ol>
<li>Первым нужно запускать скрипт для транзакции №1, а затем сразу же скрипт для транзакции №2 (не позднее чем через 10 секунд после начала выполнения первого скрипта).</li>
<li>В базе должна существовать таблица с именем Table1 и колонками Id и Value. В ней ожидается наличие одной строки:<br>
 <img src="D:\CDP\.net_tasks\Week_10\Downloads\9cd4b5c33b68472fa418af093cb58e7a"><br>
Для создания таблицы и наполнения её данными можно запустить следующий скрипт.<br>
<pre><code class="sql">IF (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'dbo' AND  TABLE_NAME = 'Table1'))
	DROP TABLE Table1

CREATE TABLE Table1  (Id INT IDENTITY, Value INT)

INSERT INTO Table1 (Value) VALUES(1)
</code></pre><br>
Так же данный скрипт желательно выполнить перед рассмотрения каждого примера. Это будет гарантировать идентичность получаемых результатов с теми, что описаны ниже.<br>
</li>
</ol><br>
</div></div><br>
<br>
<h4>Потерянное обновление (lost update)</h4><br>
Эффект проявляется при одновременном изменении одного блока данных разными транзакциями. Причём одно из изменений может теряться.<br>
Данная формулировка может по-разному интерпретироваться.<br>
<h5>Потерянное обновление – Интерпретация №1</h5><br>
Две транзакции выполняют одновременно UPDATE для одной и той же строки, и изменения, сделанные одной транзакцией, затираются другой.<br>
<table>
<tr>
<th></th>
<th>Транзакция 1</th>
<th>Транзакция 2</th>
</tr>
<tr>
<td></td>
<td><pre><code class="sql">UPDATE Table1 
SET Value = Value + 5
WHERE Id = 1;

SELECT Value 
FROM Table1
WHERE Id = 1;
</code></pre></td>
<td><pre><code class="sql">UPDATE Table1 
SET Value = Value + 7
WHERE Id = 1;

SELECT Value 
FROM Table1
WHERE Id = 1;
</code></pre></td>
</tr>
<tr>
<td>Результат:</td>
<td>Value = 6</td>
<td>Value = 8</td>
</tr>
</table><br>
<div class="spoiler"><b class="spoiler_title">Почему так происходит?</b><div class="spoiler_text">Прежде чем выполнить обновление, обе транзакции читают значение в колонке Value – оно равно 1. Предположим, что транзакция 2 успевает записать значение первой, тогда новое значение в колонке Value будет 8 (1+7). Затем транзакция 1 так же вычисляет новое значение, но для расчёта использует ранее вычитанное значение (1). В итоге после завершения транзакции 1 в колонке Value окажется 6 (1+5), а не 13 (1+7+5).<br>
К счастью в MS SQL данный сценарий невозможен, потому что даже самый низкий уровень изоляции предотвращает такую ситуацию и результатом всегда будет 13, а не 8.<br>
</div></div><br>
<br>
<h5>Потерянное обновление – Интерпретация №2</h5><br>
Сценарий аналогичен первому, но значение Value вычитывается во временную переменную.<br>
<table>
<tr>
<th></th>
<th>Транзакция 1</th>
<th>Транзакция 2</th>
</tr>
<tr>
<td></td>
<td><pre><code class="sql">BEGIN TRAN;

DECLARE @Value INT;

SELECT @Value = Value
FROM Table1
WHERE Id = 1;

WAITFOR DELAY '00:00:10';

UPDATE Table1 
SET Value = @Value + 5
WHERE Id = 1;

COMMIT TRAN;

SELECT Value 
FROM Table1
WHERE Id = 1;
</code></pre></td>
<td><pre><code class="sql">BEGIN TRAN;

DECLARE @Value INT;

SELECT @Value = Value
FROM Table1
WHERE Id = 1;



UPDATE Table1 
SET Value = @Value + 7
WHERE Id = 1;

COMMIT TRAN;

SELECT Value 
FROM Table1
WHERE Id = 1;
</code></pre></td>
</tr>
<tr>
<td>Результат:</td>
<td>Value = 6</td>
<td>Value = 8</td>
</tr>
</table><br>
<br>
<h4>«Грязное» чтение (dirty read)</h4><br>
Это такое чтение, при котором могут быть считаны добавленные или изменённые данные из другой транзакции, которая впоследствии не подтвердится (откатится).<br>
Так как данный эффект возможен только при минимальном уровне изоляции, а по умолчанию используется более высокий уровень изоляции (READ COMMITTED), то в скрипте чтения данных уровень изоляции будет явно установлен как READ UNCOMMITTED. Если вернуть уровень изоляции по умолчанию (READ COMMITTED) для транзакции 2, то поведение поменяется.<br>
<table>
<tr>
<th></th>
<th>Транзакция 1</th>
<th>Транзакция 2</th>
</tr>
<tr>
<td></td>
<td><pre><code class="sql">


BEGIN TRAN;

UPDATE Table1
SET Value = Value * 10
WHERE Id = 1;

WAITFOR DELAY '00:00:10';

ROLLBACK;

SELECT Value 
FROM Table1
WHERE Id = 1;


</code></pre></td>
<td><pre><code class="sql">SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
--SET TRANSACTION ISOLATION LEVEL READ COMMITTED;

BEGIN TRAN;









SELECT Value 
FROM Table1
WHERE Id = 1;

COMMIT TRAN;
</code></pre></td>
</tr>
<tr>
<td>Результат для READ UNCOMMITTED:</td>
<td>Value = 1</td>
<td>Value = 10</td>
</tr>
<tr>
<td>Результат для READ COMMITTED:</td>
<td>Value = 1</td>
<td>Value = 1</td>
</tr>
</table>Мы видим, что внутри второй транзакции было вычитано значение 10, которое никогда не было успешно сохранено в базу (оно было отклонено командой ROLLBACK).<br>
<br>
<h4>Неповторяющееся чтение (non-repeatable read)</h4><br>
Проявляется, когда при повторном чтении в рамках одной транзакции, ранее прочитанные данные, оказываются изменёнными. Данный эффект может наблюдаться при уровне изоляции ниже, чем REPEATABLE READ.<br>
<table>
<tr>
<th></th>
<th>Транзакция 1</th>
<th>Транзакция 2</th>
</tr>
<tr>
<td></td>
<td><pre><code class="sql">SET TRANSACTION ISOLATION LEVEL READ COMMITTED
--SET TRANSACTION ISOLATION LEVEL REPEATABLE READ
BEGIN TRAN;

SELECT Value 
FROM Table1
WHERE Id = 1;

WAITFOR DELAY '00:00:10';

SELECT Value 
FROM Table1
WHERE Id = 1;

COMMIT;
</code></pre></td>
<td><pre><code class="sql">

BEGIN TRAN;




UPDATE Table1 
SET Value = 42
WHERE Id = 1;




COMMIT TRAN;
</code></pre></td>
</tr>
<tr>
<td>Результат для READ COMMITTED</td>
<td>Value = 1<br>
Value = 42<br>
</td>
<td>Мгновенное выполнение</td>
</tr>
<tr>
<td>Результат для REPEATABLE READ</td>
<td>Value = 1<br>
Value = 1<br>
</td>
<td>Ожидание завершения транзакции 1</td>
</tr>
</table><br>
<br>
<h4>Фантомное чтение (phantom reads)</h4><br>
Можно наблюдать, когда одна транзакция в ходе своего выполнения несколько раз выбирает множество строк по одним и тем же критериям. При этом другая транзакция в интервалах между этими выборками добавляет или удаляет строки, или изменяет столбцы некоторых строк, используемых в критериях выборки первой транзакции, и успешно заканчивается. В результате получится, что одни и те же выборки в первой транзакции дают разные множества строк. Данный эффект можно наблюдать, когда уровень изоляции ниже чем SERIALIZABLE.<br>
<table>
<tr>
<th></th>
<th>Транзакция 1</th>
<th>Транзакция 2</th>
</tr>
<tr>
<td></td>
<td><pre><code class="sql">SET TRANSACTION ISOLATION LEVEL REPEATABLE READ
--SET TRANSACTION ISOLATION LEVEL SERIALIZABLE  
BEGIN TRAN;

SELECT * FROM Table1  

WAITFOR DELAY '00:00:10'  

SELECT * FROM Table1

COMMIT;
</code></pre></td>
<td><pre><code class="sql">

BEGIN TRAN;



INSERT INTO Table1 (Value)
VALUES(100)


COMMIT TRAN;
</code></pre></td>
</tr>
<tr>
<td>Результат для REPEATABLE READ:</td>
<td> — <i>первый SELECT</i><br>
ID: 1; Value: 1<br>
 — <i>второй SELECT</i><br>
ID: 1; Value: 1<br>
ID: 2; Value: 100<br>
</td>
<td>Мгновенное выполнение</td>
</tr>
<tr>
<td>Результат для SERIALIZABLE:</td>
<td> — <i>первый SELECT</i><br>
ID: 1; Value: 1<br>
 — <i>второй SELECT</i><br>
ID: 1; Value: 1<br>
</td>
<td>Ожидание завершения транзакции 1</td>
</tr>
</table><br>
<br>
<h4>Уровни изоляции</h4><br>
Понимая смысл побочных эффектов, очень просто разобраться в назначении каждого уровня изоляции, т.к. они отличаются между собой количеством побочных эффектов.<br>
<table>
<tr>
<td colspan="2" rowspan="2"></td>
<td colspan="4"><b>Эффекты</b></td>
</tr>
<tr>
<td>Потерянное обновление</td>
<td>Грязное чтение</td>
<td>Неповторяющееся чтение</td>
<td>Фантомное чтение</td>
</tr>
<tr>
<td rowspan="4"><b>Уровни изоляции</b></td>
<td> Read uncommitted<br>
 </td>
<td> Нет /Есть (*)<br>
 </td>
<td> Есть<br>
 </td>
<td> Есть<br>
 </td>
<td> Есть<br>
 </td>
</tr>
<tr>
<td> Read committed<br>
<i>или</i><br>
 Read committed Snapshot (**)<br>
 </td>
<td> Нет /Есть (*)<br>
 </td>
<td> Нет<br>
 </td>
<td> Есть<br>
 </td>
<td> Есть<br>
 </td>
</tr>
<tr>
<td> Repeatable read<br>
 </td>
<td> Нет<br>
 </td>
<td> Нет<br>
 </td>
<td> Нет<br>
 </td>
<td> Есть<br>
 </td>
</tr>
<tr>
<td> Serializable<br>
<i>или</i><br>
 Snapshot (**)<br>
 </td>
<td> Нет<br>
 </td>
<td> Нет<br>
 </td>
<td> Нет<br>
 </td>
<td> Нет<br>
 </td>
</tr>
</table><br>
(*) – эффект присутствует только в случае, если он трактуется согласно описанию в разделе «Потерянное обновление – Интерпретация №2».<br>
(**) – для данных уровней изоляция достигается не при помощи блокировок, а при помощи создания копии изменяемых данных, которые на время транзакции помещаются в tempdb; подробней <a href="D:\CDP\.net_tasks\Week_10\Downloads\ms189050(v=sql.105).aspx">тут</a>.<br>
<br>
<h4>Заключение</h4><br>
Теперь, разобравшись в назначении каждого уровня, вы уже готовы к более осмысленному использованию транзакций. Но я бы не останавливался на достигнутом. Во <a href="D:\CDP\.net_tasks\Week_10\Downloads\">второй части</a> статьи, материал будет представлять чуть меньшую практическую ценность, но при этом он не будет менее полезный. Когда-то Ли Кэмпбел однажды отлично сказал: «Вы должны понимать как минимум на один уровень абстракции ниже того уровня, на котором программируете». Именно поэтому, понимание реализации позволит максимально глубоко разобраться в теме и вы сможете правильно и эффективно пользоваться предлагаемым инструментом.</div>
    
<script class="js-mediator-script">!function(e){function t(t,n){if(!(n in e)){for(var r,a=e.document,i=a.scripts,o=i.length;o--;)if(-1!==i[o].src.indexOf(t)){r=i[o];break}if(!r){r=a.createElement("script"),r.type="text/javascript",r.async=!0,r.defer=!0,r.src=t,r.charset="UTF-8";var d=function(){var e=a.getElementsByTagName("script")[0];e.parentNode.insertBefore(r,e)};"[object Opera]"==e.opera?a.addEventListener?a.addEventListener("DOMContentLoaded",d,!1):e.attachEvent("onload",d):d()}}}t("//mediator.mail.ru/script/2820404/","_mediator")}(window);</script>

    <div class="post_additionals">
      <div class="bottom_buttons_panel panel_vote" id="voting-wjt_261097">
  <div class="label">Проголосовать:</div>
      <div class="voting-wjt voting-wjt_mobile js-voting  ">
          <button type="button" class="voting-wjt__button voting-wjt__button_plus voting-wjt__button_disabled" data-message="Голосовать могут только зарегистрированные пользователи. ">
            <svg class="icon-svg icon-svg_arrow-up" aria-hidden="true" aria-labelledby="title" version="1.1" role="img" width="15" height="24" viewbox="0 0 15 24"><path d="M6.802.129l-6.709 7.637c-.211.241-.037.615.289.615h3.629c.21 0 .38.167.38.372v14.875c0 .205.169.372.379.372h4.64c.21 0 .379-.167.379-.372v-14.876c0-.205.17-.372.38-.372h3.63c.325 0 .5-.373.289-.615l-6.709-7.637c-.153-.171-.427-.171-.578.001z"></path></svg>
          </button>

        <div class="voting-wjt__counter voting-wjt__counter_post  voting-wjt__counter_positive  js-mark">
            <span class="voting-wjt__counter-score js-score" title="Общий рейтинг 22: &uarr;22 и &darr;0">+22</span>
        </div>

          <button type="button" class="voting-wjt__button voting-wjt__button_minus voting-wjt__button_disabled" data-message="Голосовать могут только зарегистрированные пользователи. ">
            <svg class="icon-svg icon-svg_arrow-down" aria-hidden="true" aria-labelledby="title" version="1.1" role="img" width="15" height="24" viewbox="0 0 15 24"><path d="M14.574 16.233c.211-.241.037-.615-.289-.615h-3.629c-.21 0-.38-.167-.38-.372v-14.875c0-.205-.169-.372-.379-.372h-4.64c-.21 0-.379.167-.379.372v14.876c0 .205-.17.372-.38.372h-3.63c-.325 0-.5.373-.289.615l6.709 7.637c.153.171.427.171.578-.001l6.709-7.637z"></path></svg>
          </button>
      </div>
</div>
      <div class="bottom_buttons_panel panel_share">
  <div class="share_to">
    <div class="label">Поделиться:</div>
    <div class="share_buttons">
      <a href="D:\CDP\.net_tasks\Week_10\Downloads\?mobile=no" title="Опубликовать ссылку в Facebook" onclick="window.open(this.href, 'Опубликовать ссылку в Facebook', 'width=640,height=436,toolbar=0,status=0'); return false" class="fb"></a>
        <a href="D:\CDP\.net_tasks\Week_10\Downloads\?mobile=no+via+%40habrahabr" title="Опубликовать ссылку в Twitter" class="tw" onclick="window.open(this.href, 'Опубликовать ссылку  в Twitter', 'width=800,height=300,resizable=yes,toolbar=0,status=0'); return false"></a>
      <a href="D:\CDP\.net_tasks\Week_10\Downloads\?mobile=no" title="Опубликовать ссылку во ВКонтакте" onclick="window.open(this.href, 'Опубликовать ссылку во Вконтакте', 'width=800,height=300'); return false" class="vk"></a>
    </div>
  </div>

  <div class="save_to">
    <div class="label">Сохранить:</div>
    <div class="save_buttons">
      
      <a href="D:\CDP\.net_tasks\Week_10\Downloads\?mobile=no" target="_blank" title="Сохранить в Pocket" class="pocket pocket-btn"></a>
    </div>
  </div>
</div>
    </div>

    

      <div class="buttons">
          <a href="D:\CDP\.net_tasks\Week_10\Downloads\" class="btn btn-wide">
              Комментарии (4)
          </a>
      </div>
  </div>

  

    <div class="similar_posts">
      <div class="title">Похожие публикации</div>
      <div class="posts">
          <div class="post">
              <a href="D:\CDP\.net_tasks\Week_10\Downloads\" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'mobile_similar_posts', 'post'); }" class="post_inner">
                <h3 class="title">На пути к правильным SQL транзакциям (Часть 2)</h3>

                
                
                
                

                <div class="meta">
                  <span class="author">david_off</span>
                  &bull;
                  <span class="time">25 июня 2015 в 13:40</span>
                </div>
              </a>
              <a href="D:\CDP\.net_tasks\Week_10\Downloads\" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'mobile_similar_posts', 'comments'); }" class="comments_count">0</a>
          </div>
      </div>
    </div>

  

  <div class="popular_posts">
    <div class="title">Популярное за сутки</div>
    <div class="posts">
        <div class="post">
            <a href="D:\CDP\.net_tasks\Week_10\Downloads\" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'mobile_popular_posts', 'post'); }" class="post_inner">
              <h3 class="title">Codeisok, или История code review в Badoo</h3>

              
              
              
              

              <div class="meta">
                <span class="author">uyga</span>
                &bull;
                <span class="time">вчера в 16:01</span>
              </div>
            </a>
            <a href="D:\CDP\.net_tasks\Week_10\Downloads\" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'mobile_popular_posts', 'comments'); }" class="comments_count">20</a>
        </div>
        <div class="post">
            <a href="D:\CDP\.net_tasks\Week_10\Downloads\" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'mobile_popular_posts', 'post'); }" class="post_inner">
              <h3 class="title">Что я узнал на личном опыте за годы фриланса</h3>

              <div class="flag translation">перевод</div> 
              
              
              

              <div class="meta">
                <span class="author">m1rko</span>
                &bull;
                <span class="time">вчера в 16:38</span>
              </div>
            </a>
            <a href="D:\CDP\.net_tasks\Week_10\Downloads\" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'mobile_popular_posts', 'comments'); }" class="comments_count">49</a>
        </div>
        <div class="post">
            <a href="D:\CDP\.net_tasks\Week_10\Downloads\" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'mobile_popular_posts', 'post'); }" class="post_inner">
              <h3 class="title">UI-компоненты на пиксельных шейдерах: пишем ваш первый шейдер</h3>

              
              
              
              

              <div class="meta">
                <span class="author">phillennium</span>
                &bull;
                <span class="time">вчера в 16:36</span>
              </div>
            </a>
            <a href="D:\CDP\.net_tasks\Week_10\Downloads\" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'mobile_popular_posts', 'comments'); }" class="comments_count">10</a>
        </div>
        <div class="post">
            <a href="D:\CDP\.net_tasks\Week_10\Downloads\" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'mobile_popular_posts', 'post'); }" class="post_inner">
              <h3 class="title">Material Design 2.0 и Android P</h3>

              
              
              
              

              <div class="meta">
                <span class="author">jvetrau</span>
                &bull;
                <span class="time">вчера в 16:00</span>
              </div>
            </a>
            <a href="D:\CDP\.net_tasks\Week_10\Downloads\" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'mobile_popular_posts', 'comments'); }" class="comments_count">3</a>
        </div>
        <div class="post">
            <a href="D:\CDP\.net_tasks\Week_10\Downloads\" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'mobile_popular_posts', 'post'); }" class="post_inner">
              <h3 class="title">Patch Tuesday: критически важные патчи, которые вы могли пропустить</h3>

              
              
              
              

              <div class="meta">
                <span class="author">stvetro</span>
                &bull;
                <span class="time">вчера в 18:50</span>
              </div>
            </a>
            <a href="D:\CDP\.net_tasks\Week_10\Downloads\" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'mobile_popular_posts', 'comments'); }" class="comments_count">1</a>
        </div>
    </div>
  </div>


  


    

  <div class="geektimes_posts">
    <div class="title">Лучшее на Geektimes</div>
    <div class="posts">
        <div class="post">
            <a href="D:\CDP\.net_tasks\Week_10\Downloads\" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'mobile_geektimes_posts', 'post'); }" class="post_inner">
              <h3 class="title">Светодиодная лампа за 49 рублей</h3>

              
              
              
              

              <div class="meta">
                <span class="author">AlexeyNadezhin</span>
                &bull;
                <span class="time">вчера в 19:59</span>
              </div>
            </a>
            <a href="D:\CDP\.net_tasks\Week_10\Downloads\" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'mobile_geektimes_posts', 'comments'); }" class="comments_count">35</a>
        </div>
        <div class="post">
            <a href="D:\CDP\.net_tasks\Week_10\Downloads\" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'mobile_geektimes_posts', 'post'); }" class="post_inner">
              <h3 class="title">Найден третий препарат для лечения андрогенетической алопеции (облысения)</h3>

              
              
              
              

              <div class="meta">
                <span class="author">alizar</span>
                &bull;
                <span class="time">вчера в 20:24</span>
              </div>
            </a>
            <a href="D:\CDP\.net_tasks\Week_10\Downloads\" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'mobile_geektimes_posts', 'comments'); }" class="comments_count">54</a>
        </div>
        <div class="post">
            <a href="D:\CDP\.net_tasks\Week_10\Downloads\" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'mobile_geektimes_posts', 'post'); }" class="post_inner">
              <h3 class="title">Обновления от Boston Dynamics</h3>

              
              
              
              

              <div class="meta">
                <span class="author">sith</span>
                &bull;
                <span class="time">сегодня в 06:19</span>
              </div>
            </a>
            <a href="D:\CDP\.net_tasks\Week_10\Downloads\" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'mobile_geektimes_posts', 'comments'); }" class="comments_count">39</a>
        </div>
        <div class="post">
            <a href="D:\CDP\.net_tasks\Week_10\Downloads\" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'mobile_geektimes_posts', 'post'); }" class="post_inner">
              <h3 class="title">Тайна закопанного храма</h3>

              
              
              
              

              <div class="meta">
                <span class="author">ivashkos</span>
                &bull;
                <span class="time">сегодня в 07:10</span>
              </div>
            </a>
            <a href="D:\CDP\.net_tasks\Week_10\Downloads\" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'mobile_geektimes_posts', 'comments'); }" class="comments_count">24</a>
        </div>
        <div class="post">
            <a href="D:\CDP\.net_tasks\Week_10\Downloads\" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'mobile_geektimes_posts', 'post'); }" class="post_inner">
              <h3 class="title">Взламывая коды языка «Аватара»</h3>

              <div class="flag translation">перевод</div> 
              
              
              

              <div class="meta">
                <span class="author">SLY_G</span>
                &bull;
                <span class="time">вчера в 15:00</span>
              </div>
            </a>
            <a href="D:\CDP\.net_tasks\Week_10\Downloads\" onclick="if (typeof ga === 'function') { ga('send', 'event', 'tm_block', 'mobile_geektimes_posts', 'comments'); }" class="comments_count">18</a>
        </div>
    </div>
  </div>


  

      </div>
      <div id="footer" class="footer">
  <div class="footer__section">
    <span class="footer__text">Мобильное приложение</span>
    <div class="apps footer__apps js-apps">
      <a href="D:\CDP\.net_tasks\Week_10\Downloads\240693928167260216?utm_source=mobilTM&utm_medium=button&utm_campaign=appiOS" class="apps__item js-app_ios" target="_blank" onclick="if (typeof ga === 'function') { ga('send', 'event', 'footer', 'links', 'ios_app'); }">
        <img src="D:\CDP\.net_tasks\Week_10\Downloads\appstore_52.png" height="52">
      </a>

      <a href="D:\CDP\.net_tasks\Week_10\Downloads\745097116363323173?id=ru.habrahabr&utm_source=mobilTM&utm_medium=button&utm_campaign=appAndroid" class="apps__item js-app_android" target="_blank" onclick="if (typeof ga === 'function') { ga('send', 'event', 'footer', 'links', 'android_app'); }">
        <img src="D:\CDP\.net_tasks\Week_10\Downloads\gp_52.png" height="52">
      </a>
    </div>
  </div>

  <div class="footer__section"><a href="D:\CDP\.net_tasks\Week_10\Downloads\?mobile=no" class="footer__text">Полная версия</a></div>
  <div class="footer__section footer__text">2006 &#8211; 2018 &copy; TM</div>
</div>
    </div>
    <div id="sidebar_overlay"></div>

<div id="sidebar">
    <a href="D:\CDP\.net_tasks\Week_10\Downloads\" class="head">
      <img src="D:\CDP\.net_tasks\Week_10\Downloads\mobile.default_avatar.png" alt="">
      <span class="username">Вход на сайт</span>
    </a>

  <div class="menu">
    <a href="D:\CDP\.net_tasks\Week_10\Downloads\" class="posts">Лучшие</a>
    <a href="D:\CDP\.net_tasks\Week_10\Downloads\" class="posts">Все подряд</a>


    <a href="D:\CDP\.net_tasks\Week_10\Downloads\" class="hubs">Хабы</a>
    <a href="D:\CDP\.net_tasks\Week_10\Downloads\" class="companies">Компании</a>

  </div>
</div>

    <script type="text/javascript" src="D:\CDP\.net_tasks\Week_10\Downloads\"></script>

    <script type="text/javascript">
  function callGA(usesABP) {
    if (typeof window.adb1 === 'undefined') { window.adb1 = 'yes';}
    if (usesABP) { window.adb1 = 'aa'; }

    var user_type = 'guest';

    var page_type = "other";

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-726094-1',  'auto');
    ga('create', 'UA-726094-24', 'auto', {'name': 'HGM'});

    ga('require', 'displayfeatures');
    ga('set', 'dimension1', user_type); // user type - guest/readonly/habrauser
    ga('set', 'dimension2', page_type);
    ga('set', 'dimension4', window.adb1);


    (function() {
      var win = window;
      var removeUtms = function(){
        var location = win.location;
        if (location.search.indexOf('utm_') != -1 && history.replaceState) {
          history.replaceState({}, '', window.location.toString().replace(/(\&|\?)utm([_a-z0-9=-]+)/g, ""));
        }
      };
      ga('require', 'GTM-559GVC8');
      ga('send', 'pageview', { 'hitCallback': removeUtms });
    })();

    ga('HGM.set', 'dimension1', user_type);
    ga('HGM.set', 'dimension2', "habrahabr");
    ga('HGM.set', 'dimension4', window.adb1);

    ga('HGM.send', 'pageview');
  }


  if (window.habr_blockers_checker) {
    window.habr_blockers_checker.detectWrapper(callGA);
  } else {
    callGA(false)
  }

</script>

    
<!-- Yandex.Metrika counter -->
<script type="text/javascript">
(function (d, w, c) {
    (w[c] = w[c] || []).push(function() {
        try {
            if (typeof (_yaparams) != 'undefined') {
                w.yaCounter24049213 = new Ya.Metrika({id:24049213,
                    webvisor:true,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true,
                    params:_yaparams});
            } else {
                w.yaCounter24049213 = new Ya.Metrika({id:24049213,
                    webvisor:true,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true});
            }

        } catch(e) { }
    });

    var n = d.getElementsByTagName("script")[0],
        s = d.createElement("script"),
        f = function () { n.parentNode.insertBefore(s, n); };
    s.type = "text/javascript";
    s.async = true;
    s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";

    if (w.opera == "[object Opera]") {
        d.addEventListener("DOMContentLoaded", f, false);
    } else { f(); }
})(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="D:\CDP\.net_tasks\Week_10\Downloads\24049213" style="position:absolute; left:-9999px;" alt=""></div></noscript>
<!-- /Yandex.Metrika counter -->

    
    <script type="text/javascript" src="D:\CDP\.net_tasks\Week_10\Downloads\mobile.bundle.js"></script>
    <script async="" src="D:\CDP\.net_tasks\Week_10\Downloads\AF1Hvaa7qZjZ"></script>
<script>
  window._io_config = window._io_config || {};
  window._io_config["0.2.0"] = window._io_config["0.2.0"] || [];
  window._io_config["0.2.0"].push({
    "page_url": "https:\/\/m.habr.com\/company\/infopulse\/blog\/261097\/",
    "page_url_canonical": "https:\/\/habr.com\/company\/infopulse\/blog\/261097\/",
    "page_title": "На пути к правильным SQL транзакциям (Часть 1)",
    "page_type": "article",
    "page_language": "ru",
    "article_authors": [
        "david_off"
    ],
    "article_categories": [
        "h_complete_code",
        "h_sql",
        "h_mssql",
        "c_infopulse",
        "f_develop"
    ],
    "article_type": "simple",
    "article_publication_date": "Thu, 25 Jun 15 13:40:35 +0300"
});
</script>

    
  </body>
</html>
